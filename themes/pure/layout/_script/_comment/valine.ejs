<% if (typeof(script) !== 'undefined' && script) { %>
  <script src="//cdn.jsdelivr.net/npm/valine" async ></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'],
      meta = '<%= theme.comment.valine.meta %>';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  var loadValine = function(){
    if('Valine' in window) {
      Valine({
        el: '#vcomments',
        verify: <%= theme.comment.valine.verify %>,
        notify: <%= theme.comment.valine.notify %>,
        appId: '<%= theme.comment.valine.appid %>',
        appKey: '<%= theme.comment.valine.appkey %>',
        placeholder: '<%= theme.comment.valine.placeholder %>',
        avatar: '<%= theme.comment.valine.avatar %>',
        meta: meta,
        pageSize: '<%= theme.comment.valine.pageSize %>' || 10,
        visitor: <%= theme.comment.valine.visitor %>
      });
    }else {
      setTimeout(loadValine)
    }
  }
  loadValine()
  
  </script>
<% } %>
